{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h3>Conciliação ML × MP</h3>

  <form class="row g-2 mb-3" method="get">
    <div class="col-auto">
      <label class="form-label">Início</label>
      <input type="date" name="start" class="form-control" value="{{ start or '' }}">
    </div>
    <div class="col-auto">
      <label class="form-label">Fim</label>
      <input type="date" name="end" class="form-control" value="{{ end or '' }}">
    </div>
    <div class="col-auto align-self-end">
      <button class="btn btn-primary">Filtrar</button>
      <a class="btn btn-secondary" href="/conciliacao">Limpar</a>
    </div>
  </form>

  <div class="row g-3 mb-3">
    <div class="col-md-4"><div class="card"><div class="card-body"><div class="text-muted">Total líquido ML (bruta - comissão)</div><div class="h5">R$ {{ '%.2f'|format(total_ml) }}</div></div></div></div>
    <div class="col-md-4"><div class="card"><div class="card-body"><div class="text-muted">Total líquido MP (entradas)</div><div class="h5">R$ {{ '%.2f'|format(total_mp) }}</div></div></div></div>
    <div class="col-md-4"><div class="card"><div class="card-body"><div class="text-muted">Diferença (ML - MP)</div><div class="h5">R$ {{ '%.2f'|format(total_dif) }}</div></div></div></div>
  </div>

  <div class="table-responsive">
    <table class="table table-sm table-striped">
      <thead><tr><th>Dia</th><th>Líquido ML</th><th>Líquido MP</th><th>Diferença</th></tr></thead>
      <tbody>
        {% for r in rows %}
        <tr>
          <td>{{ r.dia }}</td>
          <td>R$ {{ '%.2f'|format(r.liquido_ml) }}</td>
          <td>R$ {{ '%.2f'|format(r.liquido_mp) }}</td>
          <td>R$ {{ '%.2f'|format(r.dif) }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
